(function(a,b){'use strict';function c(c,e){this.element=c,this.settings=a.extend({},d,e),this._defaults=d,this._name='saveMyForm',this._multipleList={},this._elementList=[];var f=a(c);if(this._formName=void 0===this.settings.formName?void 0===f.attr('id')?void 0===f.attr('name')?void 0:f.attr('name'):f.attr('id'):this.settings.formName,null==this._formName){var g=a('form').index(f);if(-1!==g)this._formName=b.location.pathname+'_formindex_'+g;else return void console.log('Unable to save form data - no id, name or index found')}!0===this.settings.addPathToName&&(this._formName=this._formName+'___'+b.location.pathname.slice(this.settings.addPathLength)),this.init()}var d={exclude:':password, :hidden, :file, .disable_save',include:null,formName:void 0,addPathToName:!1,addPathLength:-255,loadInputs:!0,sameNameSeparator:'___',resetOnSubmit:!0};a.extend(c.prototype,{init:function(){var b=this;a(this.element).find(':input').each(function(){b.addElement(this)}),this.storeElementList(),!0===this.settings.resetOnSubmit&&a(this.element).submit(function(){b.clearStorage()})},addElement:function(b){if(!a(b).is(this.settings.exclude)&&(null===this.settings.include||a(b).is(this.settings.include))){var c=this,d=this.getName(b);d&&(a(b).change(function(a){c.storeElement(a)}).keyup(debounce(function(a){c.storeElement(a)},500)),-1===this._elementList.indexOf(d)?this._elementList.push(d):!a(b).is(':radio')&&(!this._multipleList[d]&&(this._multipleList[d]=1),a.data(b,'multiple',this._multipleList[d]),this._elementList.push(d+this.settings.sameNameSeparator+this._multipleList[d]),this._multipleList[d]++),!0===this.settings.loadInputs&&this.loadElement(b))}},loadElement:function(b){var c=this.getName(b),d=localStorage.getItem(c);null!==d&&(d=JSON.parse(d),a(b).is(':checkbox')?a(b).prop('checked',d):a(b).is(':radio')?d==a(b).val()&&a(b).prop('checked',!0):a(b).val(d))},storeElement:function(b){var c,d=this.getName(b.target),e=a(b.target);d&&(c=a(b.target).is(':checkbox')?e.prop('checked'):e.val(),localStorage.setItem(d,JSON.stringify(c)))},getElementList:function(){return JSON.parse(localStorage.getItem('elementList_'+this._formName))||[]},storeElementList:function(){localStorage.setItem('elementList_'+this._formName,JSON.stringify(this._elementList))},clearElementList:function(){localStorage.removeItem('elementList_'+this._formName)},clearStorage:function(){try{var b=this.getElementList();a.each(b,function(a,b){localStorage.removeItem(b)})}catch(a){console.log(a)}},getName:function(b){var c=a(b),d=c.attr('id')===void 0?c.attr('name')===void 0?void 0:c.attr('name'):c.attr('id');return void 0===d?void 0:this._formName+'_'+d+(a.data(b,'multiple')===void 0?'':this.settings.sameNameSeparator+a.data(b,'multiple'))}}),a.fn.saveMyForm=function(b,d){return this.each(function(){var e=a.data(this,'plugin_saveMyForm');if(!e){var f='object'==typeof b?b:{};e=a.data(this,'plugin_saveMyForm',new c(this,f))}'string'==typeof b&&'function'==typeof e[b]&&('array'!=typeof d&&(d=[d]),e[b].apply(e,d))})}})(jQuery,window,document);// Underscore debounce function
function debounce(a,b,c){function d(){var j=Date.now()-h;j<b&&0<=j?e=setTimeout(d,b-j):(e=null,!c&&(i=a.apply(g,f),g=f=null))}var e,f,g,h,i;null==b&&(b=100);var j=function(){g=this,f=arguments,h=Date.now();var j=c&&!e;return e||(e=setTimeout(d,b)),j&&(i=a.apply(g,f),g=f=null),i};return j.clear=function(){e&&(clearTimeout(e),e=null)},j.flush=function(){e&&(i=a.apply(g,f),g=f=null,clearTimeout(e),e=null)},j}